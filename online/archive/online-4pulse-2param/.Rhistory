agent.action.mat
refdays = c(10,15,20,25)
ref.outcome.mat = matrix(NA, nrow=num_mice, ncol=length(refdays)+1)
for(mouse in 1:100){
parameter_vec=parameter_mat[mouse,]
action.vec=c()
starting.time=15-2+waitime_vec[1]
first.action = 15
one.sequence = generate_one(action.vec, parameter_vec, maxtime=starting.time)
while(length(action.vec)<num_free_pulses){
isdone=(length(action.vec)==(num_free_pulses-1))
one.state=sequence_to_state(one.sequence = as.numeric(one.sequence), action.vec = action.vec, done=isdone, total_time=total_time,num_free_pulses = num_free_pulses)
one.action = get_action(q.fit,one.state, potential_actions = potential_actions)+waitime_vec[1]
action.vec=c(action.vec, one.action)
rt.days = cumsum(action.vec)+15
seqlength = (max(rt.days)+waitime_vec[1]-2)*(1-isdone)+total_time*isdone
one.sequence = generate_one(rt.days, parameter_vec, maxtime = seqlength)
current.time = cumsum(action.vec)+15
}
for(ref.idx in 1:length(refdays)){
ref = refdays[ref.idx]
one.reference = generate_one(cumsum(c(ref,ref))+15, parameter_vec, maxtime = seqlength)
ref.outcome.mat[mouse,ref.idx]=log(one.reference[seqlength])
}
one.random = sample(potential_actions,num_free_pulses, replace=T)
one.random = one.random+waitime_vec
ref.outcome.mat[mouse,length(refdays)+1]= log(generate_one(cumsum(one.random)+15, parameter_vec, maxtime = seqlength))[seqlength]
agent.action.mat[mouse,]=action.vec
agent.outcome.vec[mouse] = log(one.sequence[seqlength])
}
adj.val=1
plot(density(-agent.outcome.vec+ref.outcome.mat[,2],adjust=adj.val), col="red", ylim=c(0,0.3),xlab="final ltv reference-final ltv agent", main="4 pulse performance", xlim=c(-.4,.4))
colors= c("red","blue", "orange", "purple")
for(ref.idx in 1:ncol(ref.outcome.mat)){
ref = refdays[ref.idx]
lines(density(ref.outcome.mat[,ref.idx] - agent.outcome.vec, adjust=adj.val), col=colors[ref.idx])
print(t.test(ref.outcome.mat[,ref.idx] - agent.outcome.vec))
delta = ref.outcome.mat[,ref.idx] - agent.outcome.vec
print(summary(delta))
print(length(delta[delta<0])/100)
}
legend("topright", legend=c(paste("day", refdays), "random"), pch=16, col=colors)
abline(v=0, lty=2)
adj.val=1
plot(density(-agent.outcome.vec+ref.outcome.mat[,2],adjust=adj.val), col="red", ylim=c(0,0.3),xlab="final ltv reference-final ltv agent", main="4 pulse performance", xlim=c(-.4,.4))
colors= c("red","blue", "orange","green", "purple")
for(ref.idx in 1:ncol(ref.outcome.mat)){
ref = refdays[ref.idx]
lines(density(ref.outcome.mat[,ref.idx] - agent.outcome.vec, adjust=adj.val), col=colors[ref.idx])
print(t.test(ref.outcome.mat[,ref.idx] - agent.outcome.vec))
delta = ref.outcome.mat[,ref.idx] - agent.outcome.vec
print(summary(delta))
print(length(delta[delta<0])/100)
}
legend("topright", legend=c(paste("day", refdays), "random"), pch=16, col=colors)
abline(v=0, lty=2)
mean(delta[delta<0])
mean(delta[delta>0])
adj.val=1
plot(density(-agent.outcome.vec+ref.outcome.mat[,2],adjust=adj.val), col="red", ylim=c(0,1),xlab="final ltv reference-final ltv agent", main="4 pulse performance", xlim=c(-.4,.4))
colors= c("red","blue", "orange","green", "purple")
for(ref.idx in 1:ncol(ref.outcome.mat)){
ref = refdays[ref.idx]
lines(density(ref.outcome.mat[,ref.idx] - agent.outcome.vec, adjust=adj.val), col=colors[ref.idx])
print(t.test(ref.outcome.mat[,ref.idx] - agent.outcome.vec))
delta = ref.outcome.mat[,ref.idx] - agent.outcome.vec
print(summary(delta))
print(length(delta[delta<0])/100)
}
legend("topright", legend=c(paste("day", refdays), "random"), pch=16, col=colors)
abline(v=0, lty=2)
adj.val=1
plot(density(-agent.outcome.vec+ref.outcome.mat[,4],adjust=adj.val), col="red", ylim=c(0,10),xlab="final ltv reference-final ltv agent", main="4 pulse performance", xlim=c(-.4,.7))
colors= c("red","blue", "orange","green", "purple")
for(ref.idx in 1:ncol(ref.outcome.mat)){
ref = refdays[ref.idx]
lines(density(ref.outcome.mat[,ref.idx] - agent.outcome.vec, adjust=adj.val), col=colors[ref.idx])
print(t.test(ref.outcome.mat[,ref.idx] - agent.outcome.vec))
delta = ref.outcome.mat[,ref.idx] - agent.outcome.vec
print(summary(delta))
print(length(delta[delta<0])/100)
}
legend("topright", legend=c(paste("day", refdays), "random"), pch=16, col=colors)
abline(v=0, lty=2)
adj.val=1
plot(density(-agent.outcome.vec+ref.outcome.mat[,4],adjust=adj.val), col="red", ylim=c(0,10),xlab="final ltv reference-final ltv agent", main="4 pulse performance", xlim=c(-.4,.7))
colors= c("red","blue", "orange","green", "purple")
for(ref.idx in 1:ncol(ref.outcome.mat)){
ref = refdays[ref.idx]
lines(density(ref.outcome.mat[,ref.idx] - agent.outcome.vec, adjust=adj.val), col=colors[ref.idx])
print(t.test(ref.outcome.mat[,ref.idx] - agent.outcome.vec))
delta = ref.outcome.mat[,ref.idx] - agent.outcome.vec
delta2 = ref.outcome.mat[,ref.idx] - ref.outcome.mat[,4]
print(summary(delta))
print(length(delta[delta<0])/100)
print(sum(delta2<0)/100)
}
legend("topright", legend=c(paste("day", refdays), "random"), pch=16, col=colors)
abline(v=0, lty=2)
adj.val=1
plot(density(-agent.outcome.vec+ref.outcome.mat[,4],adjust=adj.val), col="red", ylim=c(0,6),xlab="final ltv reference-final ltv agent", main="4 pulse performance", xlim=c(-.4,.7))
colors= c("red","blue", "orange","green", "purple")
for(ref.idx in 1:ncol(ref.outcome.mat)){
ref = refdays[ref.idx]
lines(density(ref.outcome.mat[,ref.idx] - agent.outcome.vec, adjust=adj.val), col=colors[ref.idx])
print(t.test(ref.outcome.mat[,ref.idx] - agent.outcome.vec))
delta = ref.outcome.mat[,ref.idx] - agent.outcome.vec
delta2 = ref.outcome.mat[,ref.idx] - ref.outcome.mat[,4]
print(summary(delta))
print(length(delta[delta<0])/100)
print(sum(delta2<0)/100)
}
legend("topright", legend=c(paste("day", refdays), "random"), pch=16, col=colors)
abline(v=0, lty=2)
gamma(5)
4!
factorial(4)
gamm2 = function(beta){
top = sqrt(gamma(2/beta+1) - gamma(1/beta+1)^2)
bottom = gamma(1/beta+1)
top/bottom
}
beta.vec = c(0.5,1,3,5)
gamm2 = Vectorize(function(beta){
top = sqrt(gamma(2/beta+1) - gamma(1/beta+1)^2)
bottom = gamma(1/beta+1)
top/bottom
})
beta.vec = c(0.5,1,3,5)
gamm2(beta.vec)
##problem 2 code
subject = 1:21
relapse = c(10,7,32,23,22,6,16,34,32,25,11,20,19,6,17,35,6,13,9,6,10)
censor = c(0,0,1,0,0,0,0,1,1,1,1,1,1,0,1,1,0,0,1,1,1)
all.dat = data.frame(subject, relapse, censor)
relapse.unique = sort(unique(all.dat$relapse[all.dat$censor==0]))
di = c(3,1,1,1,1,1,1)
get_ni = Vectorize(function(x){
sum(relapse>x)
})
ni = get_ni(relapse.unique)
pi = di/ni
di
ni
pi
di
ni
length(di)
length(ni)
for(jj in 1:7){print(di[jj]/ni[jj])}
1-pi
oneminuspi = 1-pi
sti = cumprod(1-pi)
Ft = 1 - sti
sti
Ft
indiv_varcontrib= cumsum(pi/(ni*(1-pi)))
varFt = (sti^2)*indiv_varcontrib
varFt
varFt = (sti^2)*indiv_varcontrib
z99 = 2.576
FU = Ft + z99*sqrt(varFt)
FL = Ft - z99*sqrt(varFt)
selnFT = sqrt(varFt)/Ft
selnSt = sqrt(varFt)/(1-Ft)
lnFU = log(Ft) + z99*selnFT
lnFL = log(Ft) - z99*selnFT
ln.CI = data.frame(lower=exp(lnFL), upper=exp(lnFU), time=relapse.unique)
ln.CI[ln.CI$upper>1,'upper']=1
xtable::xtable(ln.CI)
varFt = (sti^2)*indiv_varcontrib
z99 = 2.576
FU = Ft + z99*sqrt(varFt)
FL = Ft - z99*sqrt(varFt)
selnFT = sqrt(varFt)/Ft
selnSt = sqrt(varFt)/(1-Ft)
lnFU = log(Ft) + z99*selnFT
lnFL = log(Ft) - z99*selnFT
ln.CI = data.frame(lower=exp(lnFL), upper=exp(lnFU), time=relapse.unique)
ln.CI[ln.CI$upper>1,'upper']=1
xtable::xtable(ln.CI, caption="99% CIs based on log transform")
selnFT = sqrt(varFt)/Ft
selnSt = sqrt(varFt)/(1-Ft)
lnFU = log(Ft) + z99*selnFT
lnFL = log(Ft) - z99*selnFT
ln.CI = data.frame(lower=exp(lnFL), upper=exp(lnFU), time=as.factor(relapse.unique))
ln.CI[ln.CI$upper>1,'upper']=1
xtable::xtable(ln.CI, caption="99% CIs based on log transform", digits=4)
plot(eps.vec)
one.round = read.csv("/home/marylena/Documents/Dissertation/data/log-raw-data/Round1_log.csv")[,-c(2)]
head(one.round)
unique(one.round$group)
strsplit(as.character(unique(one.round$group)),"d")
onegp.split = strsplit(as.character(unique(one.round$group)),"d")
onegp.split = strsplit(as.character(unique(one.round$group[1])),"d")
onegp.split
as.numeric(onegp.split)
?suppressWarnings
suppressWarnings(as.numeric(onegp.split))
onegp.split = strsplit(as.character(unique(one.round$group[10])),"d")
onegp.split
onegp.split = strsplit(as.character(unique(one.round$group[30])),"d")
onegp.split
suppressWarnings(as.numeric(onegp.split))
suppressWarnings(as.numeric(unlist(onegp.split)))
suppressWarnings(as.numeric(unlist(onegp.split)))
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(unique(one.round$group[10])),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
rt.days
onegp.split
for(group_name in unique(one.round$group)){
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
cat("group: ", group_name, "rtdays: ", rt.days)
}
group_name="0Gy"
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
rt.days
mouse
mouse = one.round$X[1]
mouse
one.seq = one.round[one.round$X==mousem]
one.seq = one.round[one.round$X==mouse,]
one.seq
one.seq[!is.na(one.seq)]
one.seq[!is.na(one.seq),]
one.seq[!is.na(one.seq[1,]),]
one.seq[,!is.na(one.seq[1,])]
max(as.numeric(strsplit(colnames(one.seq[,!is.na(one.seq[1,])]), "y")))
max(as.numeric(strsplit(as.numeric(colnames(one.seq[,!is.na(one.seq[1,])])), "y")))
one.seq = one.round[one.round$X==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
one.seq
strsplit(colnames(one.seq)[ncol(one.seq)])
strsplit(colnames(one.seq)[ncol(one.seq)],"y")
as.numeric(strsplit(colnames(one.seq)[ncol(one.seq)],"y")[2])
as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y")[2]))
as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
para_set=make_default_para_set()
one.round.simulated = as.data.frame(matrix(NA, nrow=nrow(one.round), ncol=totaltime))
one.round.simulated$group=NA
one.round.simulated$ID = one.round$ID
names_for_loop=unique(c(names(parameter_vec), names(noise_vec)))
if(length(parameter_vec)>0){
for(parameter in names_for_loop){
new_para_set[parameter,'best'] = parameter_vec[parameter]
}
}
new_para_vec = new_para_set[names_for_loop,"best"] + truncnorm(1,loc =new_para_set[parameter,"best"],scale=noise_vec[parameter], lwr=para_set[parameter,"lower"], upr = para_set[parameter, "upper"])
for(mouse in unique(one.round$ID)){
group_name = new_names[one.round$group[one.round$ID==mouse]]
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
one.seq = one.round[one.round$X==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=maxtime)
one.round.simulated[one.round.simulated$ID==mouse,1:(totaltime+1)] = c(one.vec, group_name)
}
parameter_vec
noise_vec=parameter_vec
para_set=make_default_para_set()
one.round.simulated = as.data.frame(matrix(NA, nrow=nrow(one.round), ncol=totaltime))
one.round.simulated$group=NA
one.round.simulated$ID = one.round$ID
names_for_loop=unique(c(names(parameter_vec), names(noise_vec)))
if(length(parameter_vec)>0){
for(parameter in names_for_loop){
new_para_set[parameter,'best'] = parameter_vec[parameter]
}
}
new_para_vec = new_para_set[names_for_loop,"best"] + truncnorm(1,loc =new_para_set[parameter,"best"],scale=noise_vec[parameter], lwr=para_set[parameter,"lower"], upr = para_set[parameter, "upper"])
for(mouse in unique(one.round$ID)){
group_name = new_names[one.round$group[one.round$ID==mouse]]
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
one.seq = one.round[one.round$X==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=maxtime)
one.round.simulated[one.round.simulated$ID==mouse,1:(totaltime+1)] = c(one.vec, group_name)
}
para_set=make_default_para_set()
new_para_set=para_set
one.round.simulated = as.data.frame(matrix(NA, nrow=nrow(one.round), ncol=totaltime))
one.round.simulated$group=NA
one.round.simulated$ID = one.round$ID
names_for_loop=unique(c(names(parameter_vec), names(noise_vec)))
if(length(parameter_vec)>0){
for(parameter in names_for_loop){
new_para_set[parameter,'best'] = parameter_vec[parameter]
}
}
new_para_vec = new_para_set[names_for_loop,"best"] + truncnorm(1,loc =new_para_set[parameter,"best"],scale=noise_vec[parameter], lwr=para_set[parameter,"lower"], upr = para_set[parameter, "upper"])
for(mouse in unique(one.round$ID)){
group_name = new_names[one.round$group[one.round$ID==mouse]]
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
one.seq = one.round[one.round$X==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=maxtime)
one.round.simulated[one.round.simulated$ID==mouse,1:(totaltime+1)] = c(one.vec, group_name)
}
colnames(one.round)[1]="ID"
head(one.round)
para_set=make_default_para_set()
new_para_set=para_set
one.round.simulated = as.data.frame(matrix(NA, nrow=nrow(one.round), ncol=42))
one.round.simulated$group=NA
one.round.simulated$ID = one.round$ID
names_for_loop=unique(c(names(parameter_vec), names(noise_vec)))
if(length(parameter_vec)>0){
for(parameter in names_for_loop){
new_para_set[parameter,'best'] = parameter_vec[parameter]
}
}
new_para_vec = new_para_set[names_for_loop,"best"] + truncnorm(1,loc =new_para_set[parameter,"best"],scale=noise_vec[parameter], lwr=para_set[parameter,"lower"], upr = para_set[parameter, "upper"])
for(mouse in unique(one.round$ID)){
group_name = new_names[one.round$group[one.round$ID==mouse]]
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
one.seq = one.round[one.round$X==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=maxtime)
one.round.simulated[one.round.simulated$ID==mouse,1:(length(one.vec)+1)] = c(one.vec, group_name)
}
group_name = one.round$group[one.round$ID==mouse]
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
one.seq = one.round[one.round$X==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=maxtime)
one.round.simulated[one.round.simulated$ID==mouse,1:(length(one.vec)+1)] = c(one.vec, group_name)
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=maxtime)
maxtime
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
maxtime
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
one.seq = one.round[one.round$ID==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
maxtime
for(mouse in unique(one.round$ID)){
group_name = one.round$group[one.round$ID==mouse]
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
one.seq = one.round[one.round$ID==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=maxtime)
one.round.simulated[one.round.simulated$ID==mouse,1:(length(one.vec)+1)] = c(one.vec, group_name)
}
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=maxtime+7)
one.vec
###generate one dataset given noise vec
generate_one_dataset = function(noise_vec=c(), parameter_vec=c()){
para_set=make_default_para_set()
new_para_set=para_set
one.round.simulated = as.data.frame(matrix(NA, nrow=nrow(one.round), ncol=42))
one.round.simulated$group=NA
one.round.simulated$ID = one.round$ID
names_for_loop=unique(c(names(parameter_vec), names(noise_vec)))
if(length(parameter_vec)>0){
for(parameter in names_for_loop){
new_para_set[parameter,'best'] = parameter_vec[parameter]
}
}
new_para_vec = new_para_set[names_for_loop,"best"] + truncnorm(1,loc =new_para_set[parameter,"best"],scale=noise_vec[parameter], lwr=para_set[parameter,"lower"], upr = para_set[parameter, "upper"])
for(mouse in unique(one.round$ID)){
group_name = one.round$group[one.round$ID==mouse]
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
one.seq = one.round[one.round$ID==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=maxtime+7)
one.round.simulated[one.round.simulated$ID==mouse,1:(maxtime+1)] = c(one.vec[1:maxtime], group_name)
}
return(one.round.simulated)
}
shiny::runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
input_noise_vec=noise_vec
input_parameter_vec=parameter_vec
names(input_noise_vec) = c("mu","rho","lambda","omega1","omega2","BT0","TT0","Tinit")
names(input_parameter_vec) = names(input_noise_vec, input_parameter_vec)
simulated_dataset = generate_one_dataset(input_noise_vec, input_parameter_vec)
runApp('~/Documents/Dissertation/RPAI/variance')
simulated_dataset
for(mouse in unique(one.round$ID)){
group_name = one.round$group[one.round$ID==mouse]
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
one.seq = one.round[one.round$ID==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=maxtime+7)
one.round.simulated[one.round.simulated$ID==mouse,1:(maxtime+1)] = c(one.vec[1:maxtime], group_name)
}
one.round.simulated
maxtime
group_name
runApp('~/Documents/Dissertation/RPAI/variance')
simulated_dataset
names(input_noise_vec) = c("mu","rho","lambda","omega1","omega2","BT0","TT0","Tinit")
names(input_parameter_vec) = names(input_noise_vec)
simulated_dataset = generate_one_dataset(input_noise_vec, input_parameter_vec)
head(simulated_dataset)
levels(simulated_dataset$group)
levels(as.factor(simulated_dataset$group))
levels(as.factor(one.round$group))
old_names
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
source('~/Documents/Dissertation/RPAI/variance/preamble.R')
source('~/Documents/Dissertation/RPAI/variance/preamble.R')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
unique(one.round$group)
runApp('~/Documents/Dissertation/RPAI/variance')
source('~/Documents/Dissertation/RPAI/variance/generate_one_dataset.R')
runApp('~/Documents/Dissertation/RPAI/variance')
source('~/Documents/Dissertation/RPAI/variance/generate_one_dataset.R')
runApp('~/Documents/Dissertation/RPAI/variance')
group_name
group_name = one.round$group[one.round$ID==mouse]
mouse=one.round$ID[1]
group_name = one.round$group[one.round$ID==mouse]
group_name
strsplit(group_name,"_")
length(strsplit(as.character(group_name),"_"))-1
mouse=one.round$ID[15]
length(strsplit(as.character(group_name),"_"))-1
group_name
group_name = one.round$group[one.round$ID==mouse]
length(strsplit(as.character(group_name),"_"))-1
group_name
mouse=one.round$ID[10]
group_name = one.round$group[one.round$ID==mouse]
length(strsplit(as.character(group_name),"_"))-1
group_name
length(strsplit(as.character(group_name),"_"))-1
strsplit(as.character(group_name))
strsplit(as.character(group_name)m"_")
strsplit(as.character(group_name),"_")
length(strsplit(as.character(group_name)[[1]],"_"))-1
length(unlist(strsplit(as.character(group_name)),"_"))-1
length(unlist(strsplit(as.character(group_name),"_")))-1
length(unlist(strsplit(as.character("0Gy"),"_")))-1
is.pd1group = (length(unlist(strsplit(as.character(group_name),"_")))-1 ==1)
is.pd1group
for(mouse in unique(one.round$ID)){
group_name = one.round$group[one.round$ID==mouse]
is.pd1group = (length(unlist(strsplit(as.character(group_name),"_")))-1 ==1)
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
#rt.days = rt.days[rt.days!=15]
one.seq = one.round[one.round$ID==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
print(rt.days)
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=42, pd1=is.pd1group)
cat("group:",group_name, "pd1:",is.pd1group)
one.round.simulated[one.round.simulated$ID==mouse,1:(maxtime+1)] = c(one.vec[1:maxtime], as.character(group_name))
}
source('~/Documents/Dissertation/RPAI/variance/data_generation_fncs.R')
source('~/Documents/Dissertation/RPAI/variance/generate_one_dataset.R')
for(mouse in unique(one.round$ID)){
group_name = one.round$group[one.round$ID==mouse]
is.pd1group = (length(unlist(strsplit(as.character(group_name),"_")))-1 ==1)
onegp.split = suppressWarnings(as.numeric(unlist(strsplit(as.character(group_name),"d"))))
rt.days = onegp.split[!is.na(onegp.split)]+15
#rt.days = rt.days[rt.days!=15]
one.seq = one.round[one.round$ID==mouse,]
one.seq =one.seq[,!is.na(one.seq[1,])]
maxtime = as.numeric(unlist(strsplit(colnames(one.seq)[ncol(one.seq)],"y"))[2])
print(rt.days)
one.vec = generate_one(rt.days, parameter_vec=parameter_vec, maxtime=42, pd1=is.pd1group)
cat("group:",group_name, "pd1:",is.pd1group)
one.round.simulated[one.round.simulated$ID==mouse,1:(maxtime+1)] = c(one.vec[1:maxtime], as.character(group_name))
}
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
source('~/Documents/Dissertation/RPAI/variance/generate_one_dataset.R')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
runApp('~/Documents/Dissertation/RPAI/variance')
